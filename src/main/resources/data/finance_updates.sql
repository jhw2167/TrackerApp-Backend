-- SQL file for update queries (data adjustments) to finances table data and DBs


---------------- TRANSACTIONS UPDATES ----------------

-- Update all transaction values to be upper case

SELECT DISTINCT BOUGHT_FOR FROM TRANSACTIONS T
WHERE CATEGORY ='LIFESTYLE';

SELECT * FROM TRANSACTIONS T 
WHERE CATEGORY LIKE 'LIF%' AND BOUGHT_FOR LIKE 'D%';

UPDATE TRANSACTIONS 
SET PAY_METHOD = 'FAMILY CC'
WHERE PAY_METHOD LIKE 'PAREN%'

UPDATE TRANSACTIONS
SET CATEGORY = UPPER(CATEGORY),
BOUGHT_FOR = UPPER(BOUGHT_FOR),
VENDOR = UPPER(VENDOR),
PAY_METHOD = UPPER(PAY_METHOD);

UPDATE VENDORS
SET CATEGORY = UPPER(CATEGORY),
VENDOR = UPPER(VENDOR);

DELETE FROM VENDORS
WHERE vendor != UPPER(VENDOR);

SELECT * FROM VENDORS
CREATE TABLE VENDORS2 AS SELECT * FROM VENDORS V 
DELETE FROM VENDORS 

SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR

UPDATE TRANSACTIONS
SET vendor = 'WALMART'
WHERE VENDOR LIKE 'WALLMART';
SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR OFFSET 60


UPDATE TRANSACTIONS
SET vendor = 'ORIGINAL PANCAKE HOUSE'
WHERE VENDOR LIKE '%PANCAKE%';
SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR OFFSET 60

UPDATE TRANSACTIONS
SET vendor = 'MLINE TOWER'
WHERE VENDOR LIKE 'M LINE%';
SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR OFFSET 50

UPDATE TRANSACTIONS
SET vendor = 'EIGHTEEN EIGHT'
WHERE VENDOR LIKE 'EIGHTEEN EIGHT%';
SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR OFFSET 40


UPDATE TRANSACTIONS
SET vendor = 'MACYS'
WHERE VENDOR LIKE 'MACY%';

UPDATE TRANSACTIONS
SET vendor = 'EIGHTEEN EIGHT'
WHERE VENDOR LIKE 'EIGHTEEN EIGHT%';


UPDATE TRANSACTIONS
SET vendor = 'HOOTERS'
WHERE VENDOR LIKE 'HOOT%';
SELECT DISTINCT VENDOR FROM TRANSACTIONS T ORDER BY VENDOR OFFSET 40


UPDATE TRANSACTIONS
SET vendor = 'AT&T INTERNET'
WHERE VENDOR LIKE 'AT&T%';


UPDATE TRANSACTIONS 
SET CATEGORY='DINNER',
VENDOR='TERRY BLACKS'
WHERE CATEGORY LIKE 'TERRY%'

UPDATE TRANSACTIONS
SET CATEGORY = 'DINNER'
WHERE CATEGORY = 'DINNNER';

UPDATE TRANSACTIONS
SET CATEGORY = 'Snacks'
WHERE CATEGORY = 'Snack';

UPDATE TRANSACTIONS
SET vendor = 'Walmart'
WHERE VENDOR = 'Wal Mart';

UPDATE TRANSACTIONS
SET CATEGORY = 'Returns'
WHERE CATEGORY = 'Retail' AND IS_INCOME = TRUE;

UPDATE TRANSACTIONS
SET vendor = 'Venmo', notes='Graces Reimburse'
WHERE VENDOR = 'Graces Reimburse';

UPDATE TRANSACTIONS
SET CATEGORY='Reimbursement'
WHERE VENDOR = 'Venmo' AND IS_INCOME = TRUE;

UPDATE TRANSACTIONS
SET IS_INCOME =TRUE 
WHERE CATEGORY = 'Income';

UPDATE TRANSACTIONS
SET CATEGORY = 'Lifestyle'
WHERE CATEGORY = 'Lifesyle';


UPDATE TRANSACTIONS
SET BOUGHT_FOR ='DATE'
WHERE BOUGHT_FOR = 'Date';

UPDATE TRANSACTIONS
SET BOUGHT_FOR ='FAMILY'
WHERE BOUGHT_FOR = 'Family';

UPDATE TRANSACTIONS
SET BOUGHT_FOR ='PERSONAL'
WHERE BOUGHT_FOR = 'Personal';

UPDATE TRANSACTIONS
SET BOUGHT_FOR ='GROUP'
WHERE BOUGHT_FOR = 'Group';


UPDATE TRANSACTIONS
SET PAY_METHOD ='JB'
WHERE T_ID = '211008002'; -- AND 1


UPDATE TRANSACTIONS
SET BOUGHT_FOR ='PERSONAL'
WHERE T_ID = '20211227004'; 


UPDATE TRANSACTIONS
SET CATEGORY = 'Domestic'
WHERE CATEGORY = 'Domistic';

UPDATE TRANSACTIONS
SET CATEGORY = 'Car'
WHERE CATEGORY = 'Gas';

UPDATE TRANSACTIONS
SET CATEGORY = 'Lifestyle'
WHERE CATEGORY = 'Amazon';


UPDATE TRANSACTIONS
SET CATEGORY = 'Dinner'
WHERE VENDOR = 'Jaxon Beer Garden';

UPDATE TRANSACTIONS
SET CATEGORY = 'Lifestyle'
WHERE VENDOR = 'HYTOOF';

UPDATE TRANSACTIONS
SET VENDOR = 'At&T Internet'
WHERE VENDOR = 'At&T';


UPDATE TRANSACTIONS
SET VENDOR = 'Del Friscos'
WHERE VENDOR LIKE 'Del Frisco%';


UPDATE TRANSACTIONS
SET VENDOR = 'Yumilicious'
WHERE VENDOR LIKE 'Yum%';


UPDATE TRANSACTIONS
SET VENDOR = 'Original Pancake House', CATEGORY='Breakfast'
WHERE VENDOR LIKE '%Pancake%';

UPDATE TRANSACTIONS
SET CATEGORY='Local Travel'
WHERE VENDOR LIKE 'Parking%';


UPDATE TRANSACTIONS
SET CATEGORY='Lunch'
WHERE VENDOR LIKE 'Press Waffles';


UPDATE TRANSACTIONS
SET CATEGORY='Dinner'
WHERE VENDOR LIKE 'Raising Canes';

UPDATE TRANSACTIONS
SET CATEGORY='Terry Blacks'
WHERE VENDOR LIKE 'Terry Black%';

UPDATE TRANSACTIONS
SET VENDOR='Shell'
WHERE VENDOR LIKE 'Shell Oil';

SELECT * FROM TRANSACTIONS T 
WHERE VENDOR LIKE '%Pancake%';

UPDATE TRANSACTIONS T
SET VENDOR = a.capVend
FROM (
		SELECT t_id, INITCAP(vendor) AS capVend FROM TRANSACTIONS
) a
WHERE a.T_ID = T.T_ID;

---------------- END TRANSACTIONS UPDATES ----------------
